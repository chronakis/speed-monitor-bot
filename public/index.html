<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <script
        src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
        crossorigin="anonymous">
  </script>
  <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-core.js"></script>
  <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-service.js"></script>
  <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-ui.js"></script>
  <script type="text/javascript" src="https://js.api.here.com/v3/3.1/mapsjs-mapevents.js"></script>
  <link rel="stylesheet" type="text/css" href="https://js.api.here.com/v3/3.1/mapsjs-ui.css" />

  
  <script src="here-api.js" crossorigin="anonymous"></script>
  <script src="cookie.js" crossorigin="anonymous"></script>
  <script src="explore.js" crossorigin="anonymous"></script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-20549SQ8SR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-20549SQ8SR');
  </script>

<style>
body {
  font-family: sans-serif;
  font-size: 14px;
}
#test-cont {
  position: relative;
}
#flow-cont {
  position: relative;
}
#map {
  position: absolute;
  right: 0px;
  top: 0px;
  width: 59%;
  height: 460px;
  border: 1px solid #cdced0;
  background-color: #e4e6e9;
}
#results {
  width:  39%;
  height: 450px;
  border: thin solid grey;
  background: #ddd;
  padding: 0.5em;
  line-height: 1.6em;
  white-space: pre-wrap;
  overflow: scroll;
}
#flow-data {
  position: absolute;
  right: 0px;
  top: 0px;
  width: 59%;
  min-height: 20px;
  background: #eef;
  border: thin solid #cce;
}
#flow-data-inner {

}
#flow-data table {
  border-collapse: collapse; 
  font-family: monospace;
}
#flow-data th, #flow-data td {
  border: 1px solid #fff;
  padding: .3em .6em;
}

.hspace {
  display: inline-block;
  width:  2em;
}
.hspace2 {
  display: inline-block;
  width:  6em;
}
.infopar {
  position: relative;
  border:  thin solid #ccc;
  padding: .3em .2em;
}

label.inputrow, span.inputrow {
  width: 180px;
  display: inline-block;
}


.inputpar {
  margin: .4em;
}

.parbutton {
  position: absolute;
  right:  .3em;
  bottom: .3em;
}

#config-output {
  width: 40%;
  background: #efe;
  border: thin solid #cfc;
}
.roadHeader {
  border-bottom: thin dashed grey;
  margin-bottom: .5em;
}

#speedTable {
  width: 100%;
}

#speedTable .number {
  text-align: right;
}

#header {
  font-size: 1.2em;
  margin-bottom: .3em;
  padding: .5em;
  background: #7CE;
  border: thin solid #cce;
}
#github {
  float:  right;
}
#header a:link, #header a:visited {
  text-decoration: none;
  color: blue;
}
</style>
</head>
<body>
  <div id="header">
    Speed Monitoring Bot - Traffic/Speed data explorer tool
    <div id="github"><a href="https://github.com/chronakis/speed-monitor-bot">Project home at github</a></div>
  </div>
  <div class="infopar">
    <div class="inputpar">
    <div class="inputpar">
      Enter your HERE Maps API key and optionally a starting bouding box (defaults to London).
      You can get an API key from <a href="https://developer.here.com/" target="_blank">developer.here.com</a> for free.
    </div>
      <label for="bbox" class="inputrow">API Key: </label><input type="text" name="apiKey" id="apiKey" size="40" />
      The key will be saved in a cookie after the first request.
      <a href="#" onclick="eraseParamsCookie(); return false;">Click here to erase cookie</a>
    </div>
    <div class="inputpar">
      <label for="bbox" class="inputrow">Bounding Box (bbox): </label><input type="text" name="bbox" id="bbox" size="40" value="51.5298310569666,-0.15522547772949555;51.520013962290236,-0.1218844144792921"/>
      <input type="button" name="Set bbox from map" id="bboxFromMap" value="Set bbox to the current map view" onclick="mapToBBox()"/>
    </div>
    <div class="inputpar">
      <span class="inputrow">Units:</span>
      <input type="radio" id="metric" value="metric" name="units" checked/>
      <label for="metric">Metric</label>
      <span class="hspace"></span>
      <input type="radio" id="imperial" value="imperial" name="units"/>
      <label for="imperial">Imperial</label>
    </div>
    <div class="inputpar">
      <label for="go" class="inputrow"></label>
      <input type="button" name="go" id="go" value="Fetch map and traffic data" onclick="updateMap()"/>
      <span class="hspace"></span>
      (Note for devs: If you want to inspect the raw flow data, they are in the global variable called <b>trdata</b>)
    </div>
  </div>
  <div id="test-cont">
    <div id="results-cont">
      <div id="results"></div>
    </div>
    <div id="map">
    </div>
  </div>
  <div id="flow-cont">
    <div id="config-output">
      <p>The LI and PC identify the road and section. Copy them in your bot-config.js file</p>
      <div class="inputpar">
        <label for="li" class="inputrow">LI (Road Id): </label><input type="text" name="li" id="li" readonly/><span class="hspace"></span>
      </div>
      <div class="inputpar">
        <label for="pc" class="inputrow">PC (Segment Id): </label><input type="text" name="pc" id="pc" readonly/>
      </div>
    </div>
    <div id="flow-data">
      <div id="flow-data-header" class="inputpar">
        Speed data from the section will be shown below. Details on the metrics can be found at <a href="https://developer.here.com/documentation/traffic/dev_guide/topics/common-acronyms.html" target="_blank">HERE Maps documentation</a>
      </div>
      <div id="flow-data-inner"></div>
    </div>
  </div>
</body>
</html>
